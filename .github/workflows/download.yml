name: Download CICMalAnal2017

on:
  workflow_dispatch:

permissions:
  contents: write

jobs:
  download-and-upload:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Download Ransomware APKs
        run: |
          curl -O -L -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36" \
-H "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8" \
-H "Accept-Language: en-US,en;q=0.5" \
-H "Connection: keep-alive" \
http://cicresearch.ca/CICDataset/CICMalAnal2017/Dataset/APKs/Ransomware-APKs.zip
          ls -lh Ransomware-APKs.zip
          # 检查文件大小是否接近 100MB
          if [ $(stat -c%s Ransomware-APKs.zip) -lt 100000000 ]; then
            echo "文件大小小于 100MB，下载可能不完整。"
            exit 1
          fi

      - name: Upload to Release
        uses: ncipollo/release-action@v1
        with:
          tag: cic-apks
          artifacts: "Ransomware-APKs.zip"
          allowUpdates: true
          token: ${{ secrets.GITHUB_TOKEN }}
